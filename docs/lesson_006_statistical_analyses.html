<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Author: Ravin Poudel" />


<title>Statistical Analyses</title>

<script src="site_libs/header-attrs-2.26/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-6.4.2/css/all.min.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet" />
<link rel="stylesheet" href="site_libs_extra/academicons-1.8.0/css/academicons.css"/>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>






<link rel="stylesheet" href="style.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html"></a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="about.html">
    <span class="fa fa-info-circle  fa-1x"></span>
     
    About
  </a>
</li>
<li>
  <a href="Agenda.html">Agenda</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Before you come
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="computer_setup.html">Before you come</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-book  fa-1x"></span>
     
    Lessons
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="lesson_000_R_Rstudio_project.html">Project Management, R, &amp; RStudio</a>
    </li>
    <li>
      <a href="lesson_001_basic_ds_inR.html">Getting started with R</a>
    </li>
    <li>
      <a href="lesson_002_spreadsheets.html">Spreadsheets</a>
    </li>
    <li>
      <a href="lesson_003_working_with_spreadsheet.html">Working with Spreadsheets</a>
    </li>
    <li>
      <a href="lesson_06_data_manipulation_pt1.html">Data Manipulation</a>
    </li>
    <li>
      <a href="lesson_09_data_viz_pt1.html">Data Visualization</a>
    </li>
    <li>
      <a href="lesson_006_statistical_analyses.html">Statistical Analyses</a>
    </li>
  </ul>
</li>
<li>
  <a href="participants.html">Program Participants</a>
</li>
<li>
  <a href="slack.html">Join Slack Workspace</a>
</li>
<li>
  <a href="Opportunities.html">Opportunities</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="contact.html">
    <span class="fa fa-hand-spock-o"></span>
     
    Contact
  </a>
</li>
<li>
  <a href="https://www.garrettlab.com">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Statistical Analyses</h1>
<h4 class="author">Author: Ravin Poudel</h4>
<h4 class="date">Updated: 2024-06-01</h4>

</div>


<div id="descriptive-and-inferential-statistics" class="section level3">
<h3>Descriptive and Inferential Statistics</h3>
<p>We’ll cover <strong>descriptive and inferential statistics</strong>,
offering a high-level view of data.</p>
<p><em>Descriptive statistics</em> organize and summarize data,
answering questions like “Where is the center and what is the spread of
measurements?”</p>
<p><strong>Inferential statistics</strong> draw conclusions about a
population from a sample, assessing reliability. For instance, “Are
apples the same as oranges?” or “Given differences between measurements,
how likely is it that apples and oranges differ?” Inferential stats use
probability theory to generalize findings. R provides various methods
for both conventional and advanced approaches to statistical
analysis.</p>
<div id="data-display-and-characterization" class="section level4">
<h4>Data Display and Characterization</h4>
<pre class="r"><code>library(dplyr)
meta_df &lt;- read.csv(&quot;input_data/tomato_grafting_metadata.csv&quot;, header = TRUE)
yield_df &lt;- read.csv(&quot;input_data/tomato_grafting_yield_spad.csv&quot;, header = TRUE)

# merge metadata with yield data
yield_with_meata_df &lt;- merge(yield_df, meta_df, by=&quot;plantID&quot;)

pie(table(yield_with_meata_df$rootstock))</code></pre>
<p><img src="lesson_006_statistical_analyses_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p>
<pre class="r"><code>pie(table(yield_with_meata_df$sampling_date))</code></pre>
<p><img src="lesson_006_statistical_analyses_files/figure-html/unnamed-chunk-1-2.png" width="672" /></p>
<pre class="r"><code>hist(yield_with_meata_df$spad_value)</code></pre>
<p><img src="lesson_006_statistical_analyses_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<pre class="r"><code>hist(yield_with_meata_df$marketable_yield_kg)</code></pre>
<p><img src="lesson_006_statistical_analyses_files/figure-html/unnamed-chunk-2-2.png" width="672" /></p>
<pre class="r"><code>plot(yield_with_meata_df$marketable_yield_kg,type=&quot;p&quot;,main=&quot;marketable_yield_kg&quot;,ylab=&quot;Yiled ~ Kg&quot;)</code></pre>
<p><img src="lesson_006_statistical_analyses_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<pre class="r"><code>plot(yield_with_meata_df$spad_value, type =&quot;p&quot;,main=&quot;SPAD&quot;,ylab=&quot;SPAD&quot;)</code></pre>
<p><img src="lesson_006_statistical_analyses_files/figure-html/unnamed-chunk-3-2.png" width="672" /></p>
<p><strong>Mean</strong></p>
<pre class="r"><code>mean(yield_with_meata_df$marketable_yield_kg);</code></pre>
<pre><code>## [1] 29.25562</code></pre>
<p><strong>Median</strong></p>
<pre class="r"><code>median(yield_with_meata_df$marketable_yield_kg)</code></pre>
<pre><code>## [1] 24.65</code></pre>
<p><strong>SD</strong></p>
<pre class="r"><code>sd(yield_with_meata_df$marketable_yield_kg, na.rm = TRUE) </code></pre>
<pre><code>## [1] 12.35358</code></pre>
<p><strong>MAD</strong></p>
<pre class="r"><code>mad(yield_with_meata_df$marketable_yield_kg, na.rm = TRUE) </code></pre>
<pre><code>## [1] 6.22692</code></pre>
<p>Note that sd() and mad() (like many other functions) have optional
parameter na.rm; when it set to T it instructs the function to discard
all NA’s from the input vector and apply the computations to the
remaining data.</p>
<p>Other useful characteristics are:</p>
<p><strong>Range</strong> is simply the min-to-max range of all observed
values in the data.</p>
<pre class="r"><code>range(yield_with_meata_df$marketable_yield_kg,na.rm=T) # range of all observed values, min to max</code></pre>
<pre><code>## [1] 10.5 55.1</code></pre>
<p><strong>Interquartile range(IQR)</strong> is yet another robust
characteristic of the data defined similarly to a median. Namely, just
like the median is the midpoint of the data, we can also define a lower
quartile (Q1) as a value such that 25% of the observed data values are
below Q1. Similarly, the upper quartile (Q3) is such a value that only
25% of the observed values are above (Q3), and the rest is below Q3.
Interquartile distance is then defined as <code>IQR=Q3-Q1</code>.</p>
<pre class="r"><code>IQR(yield_with_meata_df$marketable_yield_kg,na.rm=T) # interquartile distance</code></pre>
<pre><code>## [1] 14.5</code></pre>
<p><strong>Box Plot fivenum</strong></p>
<p>To conclude this section, let us examine another extremely useful
visualization of the distribution of the data values, a box-and-whisker
plot (or simply a “boxplot”). Boxplot is based on the “5-number” summary
of the observed data: (Min, lower quartile, median, upper quartile,
max).</p>
<pre class="r"><code>fivenum(yield_with_meata_df$marketable_yield_kg, na.rm = TRUE) </code></pre>
<pre><code>## [1] 10.50 21.15 24.65 37.95 55.10</code></pre>
<p>Here, fivenum provides:</p>
<ul>
<li>First value ~ Minimum : 10.50</li>
<li>Second value ~ Q1 : 21.15</li>
<li>Third value ~ Q2/median : 24.65</li>
<li>Fourth value ~ Q3 : 37.95</li>
<li>Fifth value ~ Maximum : 55.10</li>
</ul>
<p>In the boxplot, the box is drawn from lower to upper quartile
(i.e. the height of the box is equal to IQR, 50% of the observed values
are within the box), the median of the data is marked with a line inside
the box, and the whiskers show the tails of the distribution of the
data: lower whisker is drawn to Lower quartile – 1.5 IQR or to the Min,
whichever is greater, and the upper whisker extends to Upper quartile +
1.5 IQR or to the Max, whichever is less. Data points that fall outside
of the whiskers (i.e. those that are located far from the center and are
likely outliers and/or very long tails of the distribution) are drawn,
if present, as individual dots. The commands and the resulting plots are
shown below.</p>
<div
style="display: flex; justify-content: center; align-items: center; height: 30vh;">
<p><img src="img/IQR.png" width="500" /></p>
</div>
<pre class="r"><code># Create a boxplot for the &#39;marketable_yield_kg&#39; column in &#39;yield_with_meata_df&#39; dataframe
boxplot(yield_with_meata_df$marketable_yield_kg, na.rm = TRUE, horizontal = TRUE)</code></pre>
<p><img src="lesson_006_statistical_analyses_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
</div>
<div id="statistical-analysis" class="section level4">
<h4>Statistical Analysis</h4>
<p><strong>ANOVA (Analysis of Variance Model)</strong> is often used
when there are more than two groups to compare, and it helps determine
whether there are statistically significant differences among the means
of these groups.</p>
<p><strong><em>Which rootstock shows better results? Is there a
treatment effect in the mean yield across the
rootstocks?</em></strong></p>
<pre class="r"><code># how to run the ANOCA in R
help(aov)</code></pre>
<p>The ANOVA test will evaluate whether there are significant
differences in the mean <code>marketable_yield_kg</code> across
different levels of the <code>rootstock</code> variable. If the p-value
associated with the <code>rootstock</code> variable is below a certain
significance level (e.g., 0.05), we would reject the null hypothesis,
concluding that there are significant differences in
<code>marketable_yield_kg</code> between at least two levels of the
<code>rootstock</code> variable.</p>
<p>In the code
<code>aov(formula = marketable_yield_kg ~ rootstock, data = yield_with_meata_df)</code>,
we are conducting an Analysis of Variance (ANOVA) to explore the
relationship between the <code>marketable_yield_kg</code> variable
(dependent variable) and the <code>rootstock</code> variable
(independent variable) using the data stored in the
<code>yield_with_meata_df</code> dataframe.</p>
<p>Let’s break down the components:</p>
<ol style="list-style-type: decimal">
<li><p><strong><code>aov()</code></strong>: This function in R stands
for “Analysis of Variance.” It is used to perform ANOVA, which is a
statistical method used to analyze the differences among group means in
a sample.</p></li>
<li><p><strong><code>formula = marketable_yield_kg ~ rootstock</code></strong>:
This part defines the formula for the ANOVA. It specifies that
<code>marketable_yield_kg</code> is the dependent variable, and
<code>rootstock</code> is the independent variable. The <code>~</code>
symbol separates the dependent variable from the independent
variable.</p></li>
<li><p><strong><code>data = yield_with_meata_df</code></strong>: This
specifies the dataframe <code>yield_with_meata_df</code> from which the
variables are taken. It tells R where to find the variables specified in
the formula.</p></li>
</ol>
<pre class="r"><code>m1_yield_avo &lt;- aov(formula=marketable_yield_kg ~ rootstock, data=yield_with_meata_df) </code></pre>
<p>Let’s check the ‘Value’ section of the help page so we know what does
it return. It returns an object, which can further be explored with
print() and summary(). Let’s assign it to an object so that we can use
print() and summary() on it.</p>
<pre class="r"><code>summary(m1_yield_avo)</code></pre>
<pre><code>##              Df Sum Sq Mean Sq F value Pr(&gt;F)    
## rootstock     3  22063    7354     521 &lt;2e-16 ***
## Residuals   156   2202      14                   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
</div>
<div id="what-is-in-the-summary-of-the-model" class="section level3">
<h3>What is in the summary of the model?</h3>
<p>The ANOVA results indicate the statistical significance of the
<code>rootstock</code> variable in explaining the variation in the
<code>marketable_yield_kg</code> variable. Let’s interpret the key
components:</p>
<ul>
<li><p><strong>Df (Degrees of Freedom)</strong>: This column displays
the degrees of freedom associated with the <code>rootstock</code>
variable and the residuals. In this case, there are 3 degrees of freedom
for <code>rootstock</code> and 156 degrees of freedom for
residuals.</p></li>
<li><p><strong>Sum Sq (Sum of Squares)</strong>: This column shows the
sum of squared deviations from the mean for <code>rootstock</code> and
residuals. For <code>rootstock</code>, the sum of squares is 23478,
while for residuals, it is 138.</p></li>
<li><p><strong>Mean Sq (Mean Square)</strong>: This is the mean square,
calculated by dividing the sum of squares by the degrees of freedom. For
<code>rootstock</code>, it is 7826 (23478 divided by 3), while for
residuals, it is 1 (138 divided by 156).</p></li>
<li><p><strong>F value</strong>: This is the F-statistic, which is the
ratio of the mean square for <code>rootstock</code> to the mean square
for residuals. It is used to test the null hypothesis that all group
means are equal. Here, the F value is 8826.</p></li>
<li><p><strong>Pr(&gt;F)</strong>: This is the p-value associated with
the F-statistic. It represents the probability of observing an
F-statistic as extreme as, or more extreme than, the one computed from
the sample data, assuming the null hypothesis (no effect of
<code>rootstock</code>) is true. In this case, the p-value is less than
2e-16 (a very small number close to zero), indicating strong evidence
against the null hypothesis.</p></li>
</ul>
<p>Overall, the results suggested that the <code>rootstock</code>
variable has a statistically significant effect on the
<code>marketable_yield_kg</code> variable. The extremely low p-value
indicates that the observed differences in mean
<code>marketable_yield_kg</code> among different levels of
<code>rootstock</code> are highly unlikely to be due to random
chance.</p>
<p><strong>Which treatments are different???</strong></p>
<p>Now that we know that differences exist between our treatments, how
can we find which treatments are different? We can do this by using
Tukey’s post-hoc test. If you scroll down the help page of aov and go
the section ‘See Also’, you will see a function TukeyHSD. This is what
we need.</p>
<pre class="r"><code>TukeyHSD(m1_yield_avo) </code></pre>
<pre><code>##   Tukey multiple comparisons of means
##     95% family-wise confidence level
## 
## Fit: aov(formula = marketable_yield_kg ~ rootstock, data = yield_with_meata_df)
## 
## $rootstock
##                          diff        lwr          upr     p adj
## Nongraft-Maxifort    -26.9325 -29.114179 -24.75082061 0.0000000
## RST-04-106-Maxifort  -25.9900 -28.171679 -23.80832061 0.0000000
## Selfgraft-Maxifort   -28.2450 -30.426679 -26.06332061 0.0000000
## RST-04-106-Nongraft    0.9425  -1.239179   3.12417939 0.6766024
## Selfgraft-Nongraft    -1.3125  -3.494179   0.86917939 0.4031948
## Selfgraft-RST-04-106  -2.2550  -4.436679  -0.07332061 0.0398197</code></pre>
<p>After you conduct an ANOVA and find a significant difference between
the groups, Tukey’s HSD test allows you to determine which specific
pairs of group means are significantly different from each other. It
calculates confidence intervals for all pairwise differences between
group means and then compares these intervals to determine which
differences are statistically significant.</p>
</div>
<div id="challenge" class="section level3 blue">
<h3>Challenge</h3>
Can you run the ANOVA test using SPAD value as response? Do we see the
similar pattern?
<details>
<summary>
ANSWER
</summary>
<pre class="r"><code># build the anova model
m2_spad_avo &lt;- aov(formula=spad_value ~ rootstock, data=yield_with_meata_df) 

# get the summary of the model
summary(m2_spad_avo)


# TukeyHSD
TukeyHSD(m2_spad_avo) </code></pre>
</details>
</div>
<p><br></p>
<p><strong>How to get the figure with comparing means with statistical
significance added?</strong></p>
<p>Let get the boxplot comparing means by rootstocks, then add the level
of signifance to the same plot. For doing this we will be ggplot2 and
additional R package <code>ggpubr</code>:</p>
<pre class="r"><code>library(ggplot2)
library(ggpubr)
# change the order of the barplor
yield_with_meata_df$rootstock &lt;- factor(yield_with_meata_df$rootstock, levels = c(&quot;Nongraft&quot;,&quot;Selfgraft&quot;,&quot;RST-04-106&quot;,&quot;Maxifort&quot;))

# get the plot
gg_yiled_boxplot &lt;- yield_with_meata_df %&gt;% 
   ggplot(mapping = aes(x = rootstock, y = marketable_yield_kg)) +
   geom_jitter(alpha = 0.8) +
   geom_boxplot() +
   labs(x=&quot;Rootstocks&quot;, y=&quot;Marketable Yield (Kg)&quot;) +
   theme_classic() +
     theme(panel.grid = element_blank(),
           axis.line = element_line(linewidth = 1),
           axis.title = element_text(size = 20, face = &quot;bold&quot;),
           axis.text.x = element_text(size = 14, angle = 45, vjust = 1, hjust = 1),
           axis.text.y = element_text(size = 14))


# add stat comparision part
gg_yiled_boxplot + stat_compare_means(method = &quot;anova&quot;, label.y = 50)</code></pre>
<p><img src="lesson_006_statistical_analyses_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<pre class="r"><code>## Define the pairwise comparison - one that is more meaningful.

my_comparisons &lt;- list(
c(&quot;Nongraft&quot;, &quot;Maxifort&quot;),
c(&quot;Selfgraft&quot;, &quot;Maxifort&quot;),
c(&quot;RST-04-106&quot;, &quot;Maxifort&quot;),
c(&quot;Nongraft&quot;, &quot;Selfgraft&quot;),
c(&quot;Nongraft&quot;, &quot;RST-04-106&quot;),
c(&quot;Selfgraft&quot;, &quot;RST-04-106&quot;)) 

## add the compariopns to the the plot
gg_yiled_boxplot_with_pairwise_test &lt;- gg_yiled_boxplot + 
stat_compare_means(comparisons = my_comparisons, label = &quot;p.signif&quot;,  method = &quot;t.test&quot;)

gg_yiled_boxplot_with_pairwise_test</code></pre>
<p><img src="lesson_006_statistical_analyses_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<pre class="r"><code># Save the plot in the `output`folder
ggsave(&quot;output/figures/gg_yiled_boxplot_with_pairwise_test.pdf&quot;, height = 6, width = 8)</code></pre>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("show" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
